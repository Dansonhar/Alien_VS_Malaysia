<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Alien Copycat - Aliens vs Malaysians</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { 'fredoka': ['Fredoka', 'sans-serif'] },
                    colors: { 'sambal': '#FF5252', 'durian': '#FFD600', 'pandan': '#00E676' }
                }
            }
        }
    </script>
</head>

<body
    class="font-fredoka bg-gray-100 min-h-screen overflow-hidden touch-none select-none flex flex-col items-center justify-center">

    <!-- HUD -->
    <div id="hud" class="hidden absolute top-4 w-full px-8 flex justify-between z-50">
        <div class="text-3xl font-bold text-gray-800">Score: <span id="score" class="text-sambal">0</span></div>
        <div class="text-3xl font-bold text-gray-800">Time: <span id="timer" class="text-blue-600">30</span></div>
    </div>

    <!-- Game Grid -->
    <div id="gameGrid" class="hidden grid grid-cols-2 md:grid-cols-3 gap-4 p-4 max-w-4xl w-full">
        <!-- Cards generated by JS -->
    </div>

    <!-- Start Screen -->
    <div id="startScreen"
        class="fixed inset-0 bg-black/85 flex flex-col items-center justify-center z-[100] text-center px-4">
        <h1 class="text-5xl md:text-6xl font-bold text-purple-400 drop-shadow-[0_4px_0_#000] mb-4">
            游놓 ALIEN COPYCAT
        </h1>
        <div class="text-8xl mb-4">游놓</div>
        <p class="text-white text-xl mb-8">One of these aliens is fake!<br>Find the different one.</p>
        <button onclick="startGame()"
            class="bg-purple-600 text-white font-bold text-2xl px-12 py-4 rounded-full border-4 border-white shadow-[0_8px_0_#6A1B9A] hover:-translate-y-1 active:translate-y-1 active:shadow-[0_4px_0_#6A1B9A] transition-all">
            SPOT THEM!
        </button>
    </div>

    <!-- Success/Fail Messages -->
    <div id="message"
        class="hidden fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-6xl font-bold text-white drop-shadow-[0_4px_0_#000] z-[60] pointer-events-none">
        CORRECT!
    </div>

    <!-- End Screen -->
    <div id="endScreen"
        class="hidden fixed inset-0 bg-black/85 flex flex-col items-center justify-center z-[100] text-center px-4">
        <h1 class="text-5xl md:text-6xl font-bold text-sambal drop-shadow-[0_4px_0_#000] mb-4">
            GAME OVER
        </h1>
        <p class="text-white text-2xl mb-4">Imposters Found:</p>
        <div id="finalScore" class="text-7xl font-bold text-pandan drop-shadow-[0_4px_0_#000] mb-8">0</div>
        <button onclick="startGame()"
            class="bg-pandan text-white font-bold text-2xl px-12 py-4 rounded-full border-4 border-black shadow-[0_8px_0_#2E7D32] hover:-translate-y-1 active:translate-y-1 active:shadow-[0_4px_0_#2E7D32] transition-all">
            PLAY AGAIN
        </button>
        <button onclick="window.location.href='/'"
            class="mt-4 bg-gray-600 text-white font-bold px-6 py-2 rounded-full border-2 border-black">
            BACK TO MENU
        </button>
    </div>

    <button onclick="window.location.href='/'"
        class="fixed top-4 left-4 z-[200] bg-red-500 hover:bg-red-600 text-white font-bold px-6 py-3 rounded-xl border-4 border-black shadow-[4px_4px_0_#000] hover:shadow-[2px_2px_0_#000] hover:translate-y-[2px] transition-all flex items-center gap-2">
        <span class="text-2xl">游</span> BACK TO MENU
    </button>

    <script>
        let score = 0;
        let timeLeft = 30;
        let timerInterval;
        let difficulty = 0;
        const grid = document.getElementById('gameGrid');

        function startGame() {
            score = 0;
            timeLeft = 30;
            difficulty = 2; // Start with 2x2

            updateHUD();
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('endScreen').classList.add('hidden');
            document.getElementById('hud').classList.remove('hidden');
            grid.classList.remove('hidden');

            timerInterval = setInterval(() => {
                timeLeft--;
                updateHUD();
                if (timeLeft <= 0) endGame();
            }, 1000);

            nextRound();
        }

        function updateHUD() {
            document.getElementById('score').textContent = score;
            document.getElementById('timer').textContent = timeLeft;
        }

        function nextRound() {
            grid.innerHTML = '';

            // Determine grid size based on score
            let cols = 2;
            if (score > 3) cols = 3;
            if (score > 8) cols = 4;

            grid.className = `grid gap-4 p-4 max-w-4xl w-full grid-cols-${cols}`;
            // Tailwind doesn't support dynamic classes like this without safelisting, 
            // so let's enforce style directly for grid template cols if needed, or stick to simple classes
            grid.style.gridTemplateColumns = `repeat(${cols}, minmax(0, 1fr))`;

            const total = cols * cols;
            const imposterIndex = Math.floor(Math.random() * total);

            // Base properties
            const baseColor = `hsl(${Math.random() * 360}, 70%, 60%)`;
            const baseEye = 'NORMAL';

            for (let i = 0; i < total; i++) {
                const card = document.createElement('div');
                card.className = 'aspect-square bg-white rounded-2xl border-4 border-gray-200 shadow-lg flex items-center justify-center cursor-pointer hover:scale-105 transition-transform active:scale-95';

                let content = `
                    <div style="background-color: ${baseColor}" class="w-20 h-20 rounded-full flex items-center justify-center text-4xl">
                        游놓
                    </div>
                `;

                if (i === imposterIndex) {
                    // Make slight change
                    // 1. Color shift
                    // 2. Different emoji
                    const type = Math.random();
                    if (type < 0.5) {
                        content = `
                            <div style="background-color: ${baseColor}; filter: hue-rotate(40deg);" class="w-20 h-20 rounded-full flex items-center justify-center text-4xl">
                                游놓
                            </div>
                        `;
                    } else {
                        content = `
                            <div style="background-color: ${baseColor}" class="w-20 h-20 rounded-full flex items-center justify-center text-4xl">
                                游
                            </div>
                        `;
                    }
                    card.onclick = () => handleGuess(true);
                } else {
                    card.onclick = () => handleGuess(false);
                }

                card.innerHTML = content;
                grid.appendChild(card);
            }
        }

        function handleGuess(correct) {
            const msg = document.getElementById('message');
            if (correct) {
                score++;
                timeLeft += 2; // Bonus time
                msg.textContent = "CORRECT!";
                msg.className = "fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-6xl font-bold text-green-500 drop-shadow-[0_4px_0_#FFF] z-[60] pointer-events-none animate-bounce";
                msg.classList.remove('hidden');
                setTimeout(() => { msg.classList.add('hidden'); nextRound(); }, 500);
            } else {
                timeLeft -= 5;
                msg.textContent = "WRONG!";
                msg.className = "fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-6xl font-bold text-red-500 drop-shadow-[0_4px_0_#FFF] z-[60] pointer-events-none animate-shake";
                msg.classList.remove('hidden');
                setTimeout(() => { msg.classList.add('hidden'); }, 500);
            }
            updateHUD();
        }

        function endGame() {
            clearInterval(timerInterval);
            document.getElementById('hud').classList.add('hidden');
            grid.classList.add('hidden');
            document.getElementById('finalScore').textContent = score;
            document.getElementById('endScreen').classList.remove('hidden');
        }
    </script>
    <style>
        .animate-shake {
            animation: shake 0.5s;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translate(-50%, -50%);
            }

            25% {
                transform: translate(-55%, -50%);
            }

            75% {
                transform: translate(-45%, -50%);
            }
        }
    </style>
</body>

</html>